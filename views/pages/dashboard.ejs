<h4>ðŸ“Š Dashboard</h4>
<div class="row g-3 mb-4">
  <div class="col-md-3"><div class="card stat p-3 text-center"><h6>Total</h6><h3 id="statTotal">0</h3></div></div>
  <div class="col-md-3"><div class="card stat p-3 text-center"><h6>Running</h6><h3 id="statRunning">0</h3></div></div>
  <div class="col-md-3"><div class="card stat p-3 text-center"><h6>Sukses</h6><h3 id="statSuccess">0</h3></div></div>
  <div class="col-md-3"><div class="card stat p-3 text-center"><h6>Error</h6><h3 id="statError">0</h3></div></div>
</div>

<div class="card p-3">
  <div class="d-flex justify-content-between align-items-center">
    <h6 class="mb-0">Jadwal Terbaru</h6>
    <a class="btn btn-sm btn-outline-primary" href="/newlive">+ New Live</a>
  </div>
  <div class="table-responsive mt-3">
    <table class="table" id="tblLatest">
      <thead><tr><th>Judul</th><th>Platform</th><th>Status</th><th>Mulai</th></tr></thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script>
async function loadStats(){
  const r=await fetch("/api/schedules/stats",{credentials:"include"}); const j=await r.json();
  if(j.success){ statTotal.textContent=j.data.total; statRunning.textContent=j.data.running; statSuccess.textContent=j.data.success; statError.textContent=j.data.error; }
}
async function loadLatest(){
  const r=await fetch("/api/schedules?limit=5",{credentials:"include"}); const j=await r.json();
  if(j.success){ const tbody=document.querySelector("#tblLatest tbody"); tbody.innerHTML="";
    j.data.forEach(d=> tbody.innerHTML+=`<tr><td>${d.title}</td><td>${d.platform}</td><td>${d.status}</td><td>${d.startAt?new Date(d.startAt).toLocaleString():"-"}</td></tr>`); }
}
document.addEventListener("DOMContentLoaded",()=>{loadStats();loadLatest();setInterval(loadStats,10000);});
</script>
